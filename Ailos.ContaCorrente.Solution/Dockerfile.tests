FROM mcr.microsoft.com/dotnet/sdk:8.0 AS test

WORKDIR /src

# Copiar arquivos de projeto
COPY src/ src/
COPY tests/ tests/

# Restaurar dependÃªncias
RUN dotnet restore tests/Ailos.ContaCorrente.UnitTests/Ailos.ContaCorrente.UnitTests.csproj
RUN dotnet restore tests/Ailos.Transferencia.UnitTests/Ailos.Transferencia.UnitTests.csproj
RUN dotnet restore tests/Ailos.IntegrationTests/Ailos.IntegrationTests.csproj

# Executar testes
CMD ["sh", "-c", "echo 'ðŸ§ª Executando Testes UnitÃ¡rios ContaCorrente' && dotnet test tests/Ailos.ContaCorrente.UnitTests/Ailos.ContaCorrente.UnitTests.csproj --verbosity normal && echo 'ðŸ§ª Executando Testes UnitÃ¡rios TransferÃªncia' && dotnet test tests/Ailos.Transferencia.UnitTests/Ailos.Transferencia.UnitTests.csproj --verbosity normal && echo 'âœ… Testes ConcluÃ­dos!'"]
